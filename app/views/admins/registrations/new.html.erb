<div class="flex min-h-screen items-center justify-center p-5">
  <div class="max-w-[360px] w-full md:mx-auto">
    <div class="mb-8">
      <%= image_tag '/assets/svg/Logo.svg', alt: '', class: 'w-28 h-20 mx-auto' %>
    </div>
    <h1 class="text-2xl font-semibold text-black text-center mb-6">Sign Up</h1>
    <% resource = Admin.new %>
    <%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
      <%= render "admins/shared/error_messages", resource: resource %>
      <div class="field mb-4">
        <%= f.label :full_name , class: "capitalize text-xs font-normal text-secondary block" %>
        <%= f.text_field :full_name, placeholder: 'Enter your full name', autofocus: true, autocomplete: "email" , class: "border border-gray-2 hover:border-primary focus:ring-0 bg-gray-3 mt-2 rounded-md !outline-none text-sm placeholder-secondary block w-full px-3 py-3" %>
      </div>
      <div class="field mb-4">
        <%= f.label :email , class: "text-xs font-normal text-secondary mb-2 block" %>
        <%= f.email_field :email, placeholder: 'Enter your email', autofocus: true, autocomplete: "email" , class: "border border-gray-2 hover:border-primary focus:ring-0 bg-gray-3 mt-2 rounded-md !outline-none text-sm placeholder-secondary block w-full px-3 py-3" %>
      </div>
      <div class="field mb-4 relative">
        <%= f.label :password, class: 'text-xs font-normal text-secondary mb-2 block' %>
        <%= f.password_field :password, placeholder: 'Enter your password', autocomplete: "new-password", class: 'password-field border border-gray-2 hover:border-primary focus:ring-0 bg-gray-3 mt-2 rounded-md !outline-none text-sm placeholder-secondary block w-full px-3 py-3' %>
        <div class="absolute top-[39px] right-3.5 cursor-pointer">
          <%= image_tag '/assets/svg/Eye-icon.svg', alt: '', class: 'toggle-password size-4', id: 'togglePassword1' %>
        </div>
        <p class="text-xs text-red-500 mt-1 hidden" id="password-validation-message">Weak password</p>
      </div>
      <div class="field relative mb-5">
        <%= f.label :password_confirmation , class: 'text-xs font-normal text-secondary mb-2 block' %>
        <%= f.password_field :password_confirmation, placeholder: 'Enter your confirm password', autocomplete: "new-password" , class: 'password-field border border-gray-2 hover:border-primary focus:ring-0 bg-gray-3 mt-2 rounded-md !outline-none text-sm placeholder-secondary block w-full px-3 py-3' %>
        <div class="absolute top-[39px] right-3.5 cursor-pointer">
          <%= image_tag '/assets/svg/Eye-icon.svg', alt: '', class: 'toggle-password size-4' , id: 'togglePassword2' %>
        </div>
      </div>
      <div class="actions">
        <%= f.submit "Sign up" , class: 'py-3 w-full mb-6 rounded text-white text-sm font-medium hover:opacity-80 bg-primary transition-all cursor-pointer opacity-50 cursor-not-allowed', disabled: true %>
      </div>
    <% end %>
    <div class="flex justify-center gap-2 items-center">
      <p class="text-xs font-normal text-typo">
        Already have an account?
      </p>
      <%= render "admins/shared/links" %>
    </div>
  </div>
</div>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const passwordField = document.querySelector('.password-field');
    const validationMessage = document.getElementById('password-validation-message');
    const inputs = document.querySelectorAll('input[type="text"], input[type="email"], input[type="password"]');
    const submitButton = document.querySelector('input[type="submit"]');

    function validatePassword(password) {
      if (password.trim() === "") {
        validationMessage.classList.add("hidden");
        return true;
      }

      const weakPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{0,7}$/;
      const strongPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

      if (strongPattern.test(password)) {
        validationMessage.classList.add("hidden");
        return true;
      } else {
        validationMessage.classList.remove("hidden");
        validationMessage.textContent = "Weak password";
        return false;
      }
    }

    function toggleButtonState() {
      const passwordIsStrong = validatePassword(passwordField.value);
      const allFilled = Array.from(inputs).every(input => input.value.trim() !== "");

      submitButton.disabled = !allFilled || !passwordIsStrong;
      submitButton.classList.toggle("opacity-50", submitButton.disabled);
      submitButton.classList.toggle("cursor-not-allowed", submitButton.disabled);
    }

    inputs.forEach(input => {
      input.addEventListener('input', toggleButtonState);
    });

    passwordField.addEventListener('input', function() {
      validatePassword(passwordField.value);
      toggleButtonState();
    });

    toggleButtonState();
  });
</script>
