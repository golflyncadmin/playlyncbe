<div class="flex min-h-screen">
  <div class="w-full justify-center p-6 md:p-0 my-auto">
    <div class="max-w-[360px] w-full md:mx-auto">
      <div class="mb-8">
        <%= image_tag '/assets/svg/Logo.svg', alt: '', class: 'w-28 h-20 mx-auto' %>
      </div>
      <h1 class="text-3xl font-semibold text-black text-center mb-3">Check your e-mail</h1>
      <p class="text-sm font-normal text-center text-secondary mb-6">Enter the email address you used to register with. This will send you a new 
        email that will link you to the password change website. </p>
      <p class="text-sm font-normal text-center text-secondary mb-6">Enter the email address you used to register with. This will send you a new 
        email that will link you to the password change website. </p>
      <%= form_with url: resend_admin_reset_password_path, method: :post do |f| %>
        <div class="flex items-center justify-center relative mb-6">
          <svg class="rotate-[-90deg]" width="120" height="120" viewBox="0 0 120 120">
            <defs>
              <radialGradient id="gradientStroke" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                <stop offset="0%" stop-color="#FFFFFF"></stop>
                <stop offset="100%" stop-color="#2979FF"></stop>
              </radialGradient>
            </defs>
            <circle cx="60" cy="60" r="50" fill="none" stroke="#e6e6e6" stroke-width="10"></circle>
            <circle id="progress-circle" cx="60" cy="60" r="50" fill="none" stroke="url(#gradientStroke)" stroke-width="10" stroke-dasharray="314" stroke-dashoffset="314" stroke-linecap="round" class="transition-all duration-1000" style="stroke-dashoffset: 188.496;"></circle>
          </svg>
          <div id="timer-text" class="absolute text-2xl font-bold text-primary">00:18</div>
        </div>
        <div id="resend-button" class="actions">
          <%= f.submit "Re-send the email", class: "py-3 w-full rounded-md text-white text-sm font-medium bg-primary transition-all cursor-pointer hover:opacity-80", disabled: true %>
        </div>
      <% end %>
    </div>
  </div>
</div>
<script>
  const duration = 30;
  let timeLeft = duration;

  const radius = 50;
  const circumference = 2 * Math.PI * radius;

  const progressCircle = document.getElementById('progress-circle');
  const timerText = document.getElementById('timer-text');
  const resendButton = document.querySelector('#resend-button input[type="submit"]');

  function updateProgress() {
    const progress = ((duration - timeLeft) / duration) * circumference;
    progressCircle.style.strokeDashoffset = circumference - progress;
  }

  function formatTime(seconds) {
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = seconds % 60;
    return `0${minutes}:${remainingSeconds < 10 ? '0' + remainingSeconds : remainingSeconds}`;
  }

  function updateTimeDisplay() {
    timerText.textContent = formatTime(timeLeft);
  }

  const timerInterval = setInterval(() => {
    if (timeLeft > 0) {
      timeLeft--;
      updateProgress();
      updateTimeDisplay();
    } else {
      clearInterval(timerInterval);
      resendButton.disabled = false;
      resendButton.classList.remove('opacity-50');
      resendButton.classList.add('hover:opacity-80');
    }
  }, 1000);

  // Set initial values
  updateProgress();
  updateTimeDisplay();
</script>